# 07 - 角色权限与审计

## 1. 权限模型
采用 RBAC + 数据范围控制：
- RBAC 控制“谁能做什么”。
- 数据范围控制“能看到哪些数据”。

## 2. 角色定义
| 角色 | 核心权限 |
| :--- | :--- |
| 申请方 | 提交申请、查看进度、签约、支付、下载、提交样本 |
| 运营审核员 | 材料初审、流程流转、退回补正 |
| 业务主管 | 复审与价格确认 |
| 法务 | 合同条款审核、风险意见 |
| 财务 | 收款确认、发票处理、退款审核 |
| 资源管理员 | 资源上架、规格管理、交付控制 |
| 审计员 | 全量日志查询、导出审计报告 |
| 系统管理员 | 账号、角色、规则配置 |

## 3. 权限控制策略
1. 最小权限原则：默认无权限，按角色授权。
2. 高风险操作二次确认：导出原始数据、作废合同、规则生效。
3. 职责分离：审批与财务核销、规则发布与审计复核分离。
4. 临时授权可回收：临时角色自动到期失效。

## 4. 审计范围
必须记录以下行为：
- 登录、认证失败、权限变更。
- 申请提交、审批动作、意见修改。
- 计费规则变更、合同模板变更、合同签署。
- 支付确认、退款处理、发票作废。
- 文件下载、导出、删除、外链分享。

## 5. 日志字段规范
- 操作人ID、角色、对象ID、动作类型、结果。
- 客户端IP、设备信息、时间戳。
- 变更前后值（关键配置）。
- 关联申请号/合同号/订单号。

## 6. 审计留存与追责
- 关键审计日志最短保留期建议 3 年。
- 涉及纠纷与诉讼的数据需延长保留。
- 违规事件需形成“发现-处置-复盘”闭环记录。
